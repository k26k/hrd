<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>회원정보 보기</title>
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">

<script th:src="@{/js/signUp.js}"></script>

<script
  src="https://code.jquery.com/jquery-3.6.1.js"
  integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI="
  crossorigin="anonymous"></script>
<script th:inline="javascript">
	/*<![CDATA[*/
	$("document").ready(function(){
		$("#idCheck").click(function(){
			let id = $("#id").val();
			if(id===""){
				alert("아이디를 입력해 주세요.");
				return;
			}
			//console.log($("#id"), $("#id").val(), name);
			
			let csrfH = /*[[${_csrf.headerName}]]*/;
			let csrfP = /*[[${_csrf.parameterName}]]*/;
			let csrfT = /*[[${_csrf.token}]]*/;
			console.log("csrfH : "+csrfH);
			console.log("csrfP : "+csrfP);
			console.log("csrfT : "+csrfT);
			
			$.ajax({
				type:"post",
				url:"/ajax/checkId",
				dataType:"json",
				data:{
					"id": id,
					csrfP: csrfT
				},
				beforeSend : function(xhr)
	            {   
					/*데이터를 전송하기 전에 헤더에 csrf값을 설정한다*/
					xhr.setRequestHeader(csrfH, csrfT);
	            },
				success:function(data){
					console.log(data);
					if(data.result){
						alert(id+"은 사용 불가능한 아이디 입니다.");
					}else{
						alert(id+"은 사용 가능합니다.");
					}
				},
				error:function(error){
					alert("다시 시도해 주세요.");
					console.error(error);
					console.error(error.responseText);
				}
			});
			
		});
	});
	/*]]>*/
</script>
</head>
<body>
	<div class="container-md pt-5">
		<h2 class="text-center">회원정보 보기</h2>
		<hr>
		<div class="row justify-content-center">
			<div class="col-12">
				<br>
				<div class="row justify-content-center">
					<div class="col-12 col-sm-10 col-md-9 col-lg-7 col-xl-6 col-xxl-5">
						<form th:action="@{/system/signUp}" method="post" class="p-3 form-control" onsubmit="return signUp()">
							<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
							<p>
								<div class="row">
									<div class="col-4 text-center">
										<label for="content" class="form-label p-2">아이디</label>
									</div>
									<div class="col-8 col-md-5">
										<input class="form-control" id="id" name="id" >
									</div>
									<div class="col-12 col-md-3">
										<div class="row justify-content-end">
											<div class="col-8 col-md-12">
												<input type="button" value="중복 검사" class="col-12 btn btn-secondary" id="idCheck">
											</div>
										</div>
									</div>
								</div>
							</p>
							<p>
								<div class="row">
									<div class="col-4 text-center">
										<label for="content" class="form-label p-2">비밀번호</label>
									</div>
									<div class="col-8">
										<input class="form-control" id="password" name="password" >
									</div>
								</div>
							</p>
							<p>
								<div class="row">
									<div class="col-4 text-center">
										<label for="content" class="form-label p-2">비밀번호 확인</label>
									</div>
									<div class="col-8">
										<input class="form-control" id="password2" name="password2" >
									</div>
								</div>
							</p>
							<p>
								<div class="row">
									<div class="col-4 text-center">
										<label for="content" class="form-label p-2">이름</label>
									</div>
									<div class="col-8">
										<input class="form-control" id="name" name="name" >
									</div>
								</div>
							</p>
							<p>
								<div class="row justify-content-end">
									<div class="text-end">
										<input type="submit" class="btn btn-primary" value="회원가입">
										<input type="reset" class="btn btn-secondary" value="취소">
										<input type="button" value="뒤로가기" class="btn btn-secondary" onclick="history.go(-1)">
									</div>
								</div>
							</p>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div> 
	<br>
</body>
</html>